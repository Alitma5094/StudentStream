{% extends '_base.html' %}

{% block content %}
    <div id="modals-here" hx-target="this" hx-swap="innerHTML"></div>

    <script>
        function closeModal() {
            var container = document.getElementById("modals-here")
            var modal = document.getElementById("modal")

            modal.classList.remove("show")

            setTimeout(function () {
                container.removeChild(modal)
            }, 200)
        }
    </script>

    <div class="card">
        <div class="card-body">
            <h1 class="card-title">{{ student.first_name }} {{ student.last_name }}</h1>
            <a href="{% url 'student_update' student.id %}" class="btn btn-primary">Update</a>
            <a href="{% url 'student_delete' student.id %}" class="btn btn-danger">Delete</a>
            <ul>
                <li>First Name: {{ student.first_name }}</li>
                <li>Last Name: {{ student.last_name }}</li>
                <li>Email: {{ student.email }}</li>
                <li>Student Phone: {{ student.student_phone }}</li>
                <li>Payment ID: {{ student.payment_id }}</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h1 class="card-title">Subscriptions</h1>
            {% if subscriptions %}
                {% for subscription in subscriptions %}
                    <ul>
                        <li>ID: {{ subscription.id }}</li>
                        <li>Status: {{ subscription.status }}</li>
                    </ul>
                {% endfor %}
            {% else %}
                <p>No Subscriptions</p>
            {% endif %}

            <button
                    hx-get="{% url 'student_square_modal' student.id %}"
                    hx-target="#modals-here"
                    hx-trigger="click"
                    class="btn btn-info"
                    hx-vals='{"step": "ask"}'
                    {#                    _="on htmx:afterOnLoad wait 10ms then add .show to #modal then add .show to #modal-backdrop"#}
            >Connect
                with payment provider
            </button>
        </div>
    </div>
{% endblock %}